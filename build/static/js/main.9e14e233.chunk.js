(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){e.exports=n(47)},24:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(18),o=n.n(r),s=(n(24),n(11)),u=n(2),i=n.n(u),c=n(3),g=n(5),m=n(6),p=n(8),d=n(7),h=n(9),b=function(e){var t=e.blog;return l.a.createElement("div",null,t.title," ",t.author)},v=n(4),f=n.n(v),w=null,E={getAll:function(){return f.a.get("/api/blogs").then(function(e){return e.data})},create:function(){var e=Object(c.a)(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},e.next=3,f.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return f.a.put("".concat("/api/blogs","/").concat(e),t).then(function(e){return e.data})},setToken:function(e){w="bearer ".concat(e)}},B=function(e){var t=e.message;return null===t?null:l.a.createElement("div",{className:"error"},t)},y=function(e){var t=e.message;return null===t?null:(console.log("OkNotification with message",t),l.a.createElement("div",{className:"noerror"},t))},S=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).toggleVisibility=function(){n.setState({visible:!n.state.visible})},n.state={visible:!1},n}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e={display:this.state.visible?"none":""},t={display:this.state.visible?"":"none"};return l.a.createElement("div",null,l.a.createElement("div",{style:e},l.a.createElement("button",{onClick:this.toggleVisibility},this.props.buttonLabel)),l.a.createElement("div",{style:t},this.props.children,l.a.createElement("button",{onClick:this.toggleVisibility},"cancel")))}}]),t}(l.a.Component),k=function(e){var t=e.handleSubmit,n=e.handleChange,a=e.username,r=e.password;return l.a.createElement("div",null,l.a.createElement("h2",null,"Logint to Application"),l.a.createElement("form",{onSubmit:t},l.a.createElement("div",null,"username",l.a.createElement("input",{value:a,onChange:n,name:"username"})),l.a.createElement("div",null,"password",l.a.createElement("input",{type:"password",name:"password",value:r,onChange:n})),l.a.createElement("button",{type:"submit"},"login")))},j=function(e){var t=e.onSubmit,n=e.handleBlogChange,a=e.newBlogtitle,r=e.newBlogauthor,o=e.newBlogurl;return l.a.createElement("div",null,l.a.createElement("h2",null,"Create new Blog"),l.a.createElement("form",{onSubmit:t},l.a.createElement("div",null,l.a.createElement("label",null,"title:",l.a.createElement("input",{name:"newBlogtitle",type:"text",value:a,onChange:n}))),l.a.createElement("div",null,l.a.createElement("label",null,"author:",l.a.createElement("input",{name:"newBlogauthor",type:"text",value:r,onChange:n}))),l.a.createElement("div",null,l.a.createElement("label",null,"url:",l.a.createElement("input",{name:"newBlogurl",type:"text",value:o,onChange:n}))),l.a.createElement("button",null,"create new blog")))},C={login:function(){var e=Object(c.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/api/login",t);case 2:return n=e.sent,console.log("frontend login response.data",n.data),e.abrupt("return",n.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},O=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).addBlog=function(e){e.preventDefault();var t={title:n.state.newBlogtitle,author:n.state.newBlogauthor,url:n.state.newBlogurl};n.blogForm.toggleVisibility(),E.create(t).then(function(e){n.setState({blogs:n.state.blogs.concat(e),newBlog:"",noerror:"blog added"}),setTimeout(function(){n.setState({noerror:null})},5e3)})},n.login=function(){var e=Object(c.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,console.log("App.js login try before loginService.login"),e.next=5,C.login({username:n.state.username,password:n.state.password});case 5:a=e.sent,console.log("App.js login try after loginService.login"),window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),console.log("App.js login window.localStorage.getItem('loggedBlogAppUser')"),E.setToken(a.token),console.log("App.js login blogService.setToken"),n.setState({username:"",password:"",user:a}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),n.setState({error:"username or password is wrong"}),setTimeout(function(){n.setState({error:null})},5e3);case 18:case"end":return e.stop()}},e,this,[[1,14]])}));return function(t){return e.apply(this,arguments)}}(),n.logout=function(){var e=Object(c.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{window.localStorage.removeItem("loggedBlogappUser"),E.setToken(null),n.setState({user:null,noerror:"goodbye!"})}catch(a){n.setState({error:"problem when trying logout"}),setTimeout(function(){n.setState({error:null})},5e3)}case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.handleBlogChange=function(e){n.setState(Object(s.a)({},e.target.name,e.target.value))},n.handleLoginFieldChange=function(e){n.setState(Object(s.a)({},e.target.name,e.target.value))},n.state={blogs:[],newBlog:"",newBlogtitle:"",newBlogauthor:"",newBlogurl:"",showAll:!0,error:null,noerror:null,username:"",password:"",user:null,oklogin:null},n}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.getAll().then(function(t){return e.setState({blogs:t})});var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);this.setState({user:n,noerror:"componentDidMount"}),E.setToken(n.token)}}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement("h1",null,"Blogs"),l.a.createElement(B,{message:this.state.error}),l.a.createElement(y,{message:this.state.noerror}),null===this.state.user&&l.a.createElement(S,{buttonLabel:"login"},l.a.createElement(k,{visible:e.state.visible,username:e.state.username,password:e.state.password,handleChange:e.handleLoginFieldChange,handleSubmit:e.login})),null!==this.state.user&&l.a.createElement("div",null,l.a.createElement("p",null,e.state.user.name," logged in"),l.a.createElement("button",{onClick:e.logout},"logout")),null!==this.state.user&&l.a.createElement(S,{buttonLabel:"new blog",ref:function(t){return e.blogForm=t}},l.a.createElement(j,{onSubmit:e.addBlog,value:e.state.newBlog,newBlogtitle:e.state.newBlogtitle,newBlogauthor:e.state.newBlogauthor,newBlogurl:e.state.newBlogurl,handleBlogChange:e.handleBlogChange})),null!==this.state.user&&l.a.createElement("div",null,l.a.createElement("h2",null,"Blogs"),e.state.blogs.map(function(e){return l.a.createElement(b,{key:e._id,blog:e})})))}}]),t}(l.a.Component);o.a.render(l.a.createElement(O,null),document.getElementById("root"))}},[[19,2,1]]]);
//# sourceMappingURL=main.9e14e233.chunk.js.map